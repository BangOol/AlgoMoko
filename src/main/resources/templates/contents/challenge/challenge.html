<!DOCTYPE html>
<html lang="zxx" xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
	layout:decorate="~{layouts/layout}">

<head>
<meta charset="UTF-8">
<meta name="description" content="Ogani Template">
<meta name="keywords" content="Ogani, unica, creative, html">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<link rel="stylesheet"
	href="https://cdn.jsdelivr.net/npm/sweetalert2@11.4.10/dist/sweetalert2.min.css">
<script
	src="https://cdn.jsdelivr.net/npm/sweetalert2@11.4.10/dist/sweetalert2.min.js"></script>
<title>challenge</title>
<style type="text/css">
.blog__item__cpic img:hover {
	background: rgba(0, 0, 0, .7);
	opacity: 1;
}
</style>
</head>
<body>
	<th:block layout:fragment="content">
		<script>
		var result = '[[${msg}]]'
		if(result != ''){
			alert(result);
		}		
	</script>
		<!-- 모달창 시작 -->
		<div class="modal">
			<div class="modal_body">
				<div class="modal_title">
					<h2 id="title"></h2>
				</div>
				<div class="modal_content">
					<p id="contents"></p>
					<p>한번 도전 시 취소는 불가능합니다.</p>
				</div>
				<div class="modal_btn">
					<a href="" id="chl">
						<button class="modal_s">도전</button>
					</a>
					<button class="modal_c">취소</button>
				</div>
			</div>
		</div>
		<!-- 모달창 종료 -->
		<!-- Breadcrumb Section Begin -->
		<section class="breadcrumb-section set-bg"
			data-setbg="img/chl/chlmain.jpg">
			<div class="container">
				<div class="row">
					<div class="col-lg-12 text-center">
						<div class="breadcrumb__text">
							<h2>챌린지</h2>
							<div class="breadcrumb__option">
								<span>Challenge</span>
							</div>
						</div>
					</div>
				</div>
			</div>
		</section>
		<!-- Breadcrumb Section End -->

		<!-- Blog Section Begin -->
		<section class="blog spad">
			<div class="container">
				<div class="row">
					<div class="col-lg-4 col-md-5">
						<div class="blog__sidebar">
							<div class="blog__sidebar__search">
								<form action="/challenge?ctitle=" method="get"
									style="margin-right: 60px;">
									<input name="ctitle" type="text" placeholder="챌린지 검색">
									<button type="submit" value="검색">
										<span class="icon_search"></span>
									</button>
								</form>
							</div>
							<div class="blog__sidebar__item">
								<h4>Categories</h4>
								<ul>
									<li><a href="challenge">챌린지 목록</a></li>
									<li><a sec:authorize="hasAuthority('u1')"
										href="challenge/challenging">진행중인 챌린지</a></li>
									<li><a sec:authorize="hasAuthority('u1')"
										href="challenge/challengeEnd">완료한 챌린지</a></li>
								</ul>
							</div>
						</div>
					</div>

					<div class="col-lg-8 col-md-7">
						<div class="row">

							<th:block th:each="chl:${cList}">
								<div class="col-lg-6 col-md-6 col-sm-6">
									<div class="blog__item">
										<div class="blog__item__cpic">
											<img class="cimg" th:src="@{${chl.filepath}}"
												onerror="this.src='img/loading.png';">
												<a th:text="${chl.ccon}"></a>
										</div>
										<div class="blog__item__text">
											<ul>
												<li><i th:text="' '+'D-'+${chl.cdday}"
													class="fa fa-calendar-o"></i></li>
											</ul>
											<h5>
												<input type="hidden" th:value="${chl.cno}"> <a
													th:text="${chl.ctitle}"></a>
											</h5>
											<p th:text="${chl.cdday}+'일 동안 '+${chl.ctitle}+'에 도전하세요!'"></p>
											<a sec:authorize="hasAuthority('u1')" href="#"
												class="blog__btn" th:cno="${chl.cno}"
												th:title="${chl.ctitle}" th:dday="${chl.cdday}"
												th:onclick="chl_click(this.getAttribute('cno'), this.getAttribute('title'), this.getAttribute('dday'));">도전하기
												<span class="arrow_right"></span>
											</a>
											<div style="margin-left: 180px;">
												<a sec:authorize="hasAuthority('u0')"
													th:href="@{../challenge/cUpdate(cno=${chl.cno})}"><button
														class="site-btn">수정</button></a> <a
													sec:authorize="hasAuthority('u0')"
													th:href="@{/challenge/delete(cno=${chl.cno})}"><button
														class="site-btn">삭제</button></a>
											</div>
										</div>

									</div>
								</div>
							</th:block>
						</div>
						<div class="col-lg-12">
							<div style="float: right;">
								<button sec:authorize="hasAuthority('u0')" class="site-btn"
									th:onclick="location.href='../challenge/cWrite'">챌린지
									작성</button>
							</div>
							<div class="product__pagination blog__pagination">
								<a href="#">1</a> <a href="#">2</a> <a href="#">3</a> <a
									href="#"><i class="fa fa-long-arrow-right"></i></a>
							</div>
						</div>
					</div>
				</div>
			</div>
		</section>
		<!-- Blog Section End -->
		<script th:inline="javascript">		

	    const body = document.querySelector('body');
	    const modal = document.querySelector('.modal');  
	    
	    // 모달창 클릭 버튼
	   	function chl_click(cno, title, dday) {
	   		modal.style.display = "flex";
   	     	modal.style.overflow = 'hidden';		   	
   	     	
		   	let a = document.getElementById('title');
		   	let b = document.getElementById('contents');
			let c = document.getElementById('chl');
			a.innerHTML = title;
		   	b.innerHTML = dday+"일 동안 "+title+"에 도전하시겠습니까?";
		   	c.href = "/challenge/start?cno="+cno+"&cdday="+dday;		   
	   		}	      
	    
	   	// 모달창 닫기 버튼
	    const closeBtn = modal.querySelector(".modal_c")
	    closeBtn.addEventListener("click", e => {
	        modal.style.display = "none"
	        modal.style.overflow = 'auto';
	    })    	
		</script>
</body>
</html>